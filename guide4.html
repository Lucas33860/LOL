<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Comparaison des Items par Coût et par Stats</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
      .charts-container {
        display: flex;
        justify-content: space-between;
        gap: 20px;
        flex-wrap: wrap;
      }
      .chart-wrapper {
        flex: 1;
        min-width: 400px;
      }
      h2 {
        text-align: center;
      }
      .item-details {
        margin-top: 10px;
        font-size: 1.1em;
      }
    </style>
  </head>
  <body>
    <h1>Comparaison des Items</h1>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap");

      h1 {
        font-family: "Bebas Neue", sans-serif;
        font-size: 3rem;
        text-align: center;
        color: #612cde;
      }

      h2 {
        font-family: "Bebas Neue", sans-serif;
        font-size: 2rem;
        text-align: center;
        color: #612cde;
      }
    </style>

    <div class="charts-container">
      <div class="chart-wrapper">
        <h2>Coût des Items en Gold</h2>
        <canvas id="costChart" width="600" height="400"></canvas>
        <div id="costDetails" class="item-details"></div>
      </div>

      <div class="chart-wrapper">
        <h2>Comparaison des Stats Simplifiées</h2>
        <canvas id="statsChart" width="600" height="400"></canvas>
        <div id="statsDetails" class="item-details"></div>
      </div>
    </div>

    <script>
      const items = [
        {
          name: "Cristal de saphir",
          gold: 300,
          stats: { FlatMPPoolMod: 300 },
          category: "Mage",
        },
        {
          name: "Cristal de rubis",
          gold: 400,
          stats: { FlatHPPoolMod: 150 },
          category: "Tank",
        },
        {
          name: "Armure d'étoffe",
          gold: 300,
          stats: { FlatArmorMod: 15 },
          category: "Tank",
        },
        {
          name: "Cape de néant",
          gold: 400,
          stats: { FlatSpellBlockMod: 20 },
          category: "Tank",
        },
        {
          name: "Épée longue",
          gold: 350,
          stats: { FlatPhysicalDamageMod: 10 },
          category: "Tireur",
        },
        {
          name: "Dague",
          gold: 250,
          stats: { PercentAttackSpeedMod: 0.1 },
          category: "Tireur",
        },
        {
          name: "Collier rafraîchissant",
          gold: 300,
          stats: {},
          category: "Mage",
        },
        {
          name: "Tome d'amplification",
          gold: 400,
          stats: { FlatMagicDamageMod: 20 },
          category: "Mage",
        },
        { name: "Charme féérique", gold: 200, stats: {}, category: "Mage" },
      ];

      // Filtrer les items avec un coût de 500 gold ou moins
      const affordableItems = items.filter((item) => item.gold <= 500);

      // 1er graphique: Coût en gold des items
      function createCostChart() {
        const ctx = document.getElementById("costChart").getContext("2d");
        const labels = affordableItems.map((item) => item.name);
        const values = affordableItems.map((item) => item.gold);

        new Chart(ctx, {
          type: "bar",
          data: {
            labels: labels,
            datasets: [
              {
                label: "Coût en Gold des Items",
                data: values,
                backgroundColor: "rgba(75, 192, 192, 0.2)",
                borderColor: "rgba(75, 192, 192, 1)",
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                max: 500,
              },
            },
            onHover: (event, chartElements) => {
              if (chartElements.length > 0) {
                const index = chartElements[0].index;
                displayItemDetails("cost", affordableItems[index]);
              }
            },
          },
        });
      }

      // 2ème graphique: Comparaison simplifiée des stats pour chaque item
      function createStatsChart() {
        const ctx = document.getElementById("statsChart").getContext("2d");

        // Extraire les statistiques importantes pour chaque item
        const manaStats = affordableItems.map(
          (item) => item.stats.FlatMPPoolMod || 0
        );
        const magicDamageStats = affordableItems.map(
          (item) => item.stats.FlatMagicDamageMod || 0
        );
        const hpStats = affordableItems.map(
          (item) => item.stats.FlatHPPoolMod || 0
        );
        const armorStats = affordableItems.map(
          (item) => item.stats.FlatArmorMod || 0
        );
        const attackSpeedStats = affordableItems.map(
          (item) => (item.stats.PercentAttackSpeedMod || 0) * 100
        );
        const physicalDamageStats = affordableItems.map(
          (item) => item.stats.FlatPhysicalDamageMod || 0
        );
        const spellBlockStats = affordableItems.map(
          (item) => item.stats.FlatSpellBlockMod || 0
        );

        const datasets = [
          {
            label: "Mana (Mage)",
            data: manaStats,
            backgroundColor: "rgba(54, 162, 235, 0.6)",
            borderColor: "rgba(54, 162, 235, 1)",
            borderWidth: 1,
          },
          {
            label: "Dégâts Magiques (Mage)",
            data: magicDamageStats,
            backgroundColor: "rgba(201, 203, 207, 0.6)",
            borderColor: "rgba(201, 203, 207, 1)",
            borderWidth: 1,
          },
          {
            label: "PV (Tank)",
            data: hpStats,
            backgroundColor: "rgba(75, 192, 192, 0.6)",
            borderColor: "rgba(75, 192, 192, 1)",
            borderWidth: 1,
          },
          {
            label: "Armure (Tank)",
            data: armorStats,
            backgroundColor: "rgba(255, 99, 132, 0.6)",
            borderColor: "rgba(255, 99, 132, 1)",
            borderWidth: 1,
          },
          {
            label: "Vitesse d'Attaque (Tireur)",
            data: attackSpeedStats,
            backgroundColor: "rgba(255, 206, 86, 0.6)",
            borderColor: "rgba(255, 206, 86, 1)",
            borderWidth: 1,
          },
          {
            label: "Dégâts Physiques (Tireur)",
            data: physicalDamageStats,
            backgroundColor: "rgba(255, 159, 64, 0.6)",
            borderColor: "rgba(255, 159, 64, 1)",
            borderWidth: 1,
          },
          {
            label: "Résistance Magique (Tank)",
            data: spellBlockStats,
            backgroundColor: "rgba(153, 102, 255, 0.6)",
            borderColor: "rgba(153, 102, 255, 1)",
            borderWidth: 1,
          },
        ];

        new Chart(ctx, {
          type: "bar",
          data: {
            labels: affordableItems.map((item) => item.name),
            datasets: datasets,
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
              },
            },
            onHover: (event, chartElements) => {
              if (chartElements.length > 0) {
                const index = chartElements[0].index;
                displayItemDetails("stats", affordableItems[index]);
              }
            },
          },
        });
      }

      // Fonction pour afficher les détails de l'item
      function displayItemDetails(type, item) {
        const detailsDiv = document.getElementById(`${type}Details`);
        const stats = item.stats;
        const category = item.category;

        detailsDiv.innerHTML = `
                <strong>${item.name}</strong> (Gold: ${item.gold})<br>
                <p><strong>Rôle:</strong> ${category}</p>
                <ul>
                    ${
                      stats.FlatMPPoolMod
                        ? `<li>Mana: +${stats.FlatMPPoolMod}</li>`
                        : ""
                    }
                    ${
                      stats.FlatHPPoolMod
                        ? `<li>PV: +${stats.FlatHPPoolMod}</li>`
                        : ""
                    }
                    ${
                      stats.FlatArmorMod
                        ? `<li>Armure: +${stats.FlatArmorMod}</li>`
                        : ""
                    }
                    ${
                      stats.FlatSpellBlockMod
                        ? `<li>Résistance Magique: +${stats.FlatSpellBlockMod}</li>`
                        : ""
                    }
                    ${
                      stats.FlatPhysicalDamageMod
                        ? `<li>Dégâts Physiques: +${stats.FlatPhysicalDamageMod}</li>`
                        : ""
                    }
                    ${
                      stats.PercentAttackSpeedMod
                        ? `<li>Vitesse d'attaque: +${
                            stats.PercentAttackSpeedMod * 100
                          }%</li>`
                        : ""
                    }
                    ${
                      stats.FlatMagicDamageMod
                        ? `<li>Puissance Magique: +${stats.FlatMagicDamageMod}</li>`
                        : ""
                    }
                </ul>
            `;
      }

      // Créer les deux graphiques
      createCostChart();
      createStatsChart();
    </script>
  </body>
</html>
